# Описание подхода к разработке blockchain-based решений

Добрый день, дорогие хабровчане! Меня зовут Роман Комаров, я работаю в IBM техническим архитектором. Если вы еще не слышали о применении технологии Blockchain в сфере бизнеса, то настоятельно рекомендую ознакомиться со статьей моего коллеги, который повествует об [архитектуре и теоретической части Hyperledger Fabric](#https://habr.com/ru/company/ibm/blog/444874/), а также рекомендую ознакомиться с тем, как можно [использовать kubernetes для разработки blockchain проектов](#https://habr.com/ru/company/ibm/blog/351808/).

Помимо основной работы в нашей компании существуют возможности развиваться в других различных направлениях. Таким образом появился IBM Garage. Это то место, где опытные коллеги делятся знаниями с людьми, которые хотят расширить свои познания в той или иной области. Мы с коллегами в гараже изучаем новые технологии с разных сторон, чтобы лучше понять их и разобраться. Так я открыл для себя технологию Blockchain с новой, неизвестной мне стороны.

Цель данной публикации заключается в том, чтобы познакомить читателя с технологией Blockchain в сфере бизнеса, показать на практике как это работает, а также продемострировать важные аспекты работы Blockchain сети.

Проблема, которую мы пытались решить в нашей blockchain системе - это ведение учета студентов (бакалавров), а также их достижений, с целью снизить возможность предоставления поддельных сертификатов, грамот и т.д. За предосталенные достижения при поступлении в магистратуру могут начисляться дополнительные баллы, поэтому нашим блокчейн проектом 

Посмотреть код, склонировать репозиторий и убедиться во всем на практике вы можете в [Github](https://github.com/komaroman/StudReg) нашего проекта.

---

Я не исключаю того, что многие скорее всего уже имели дело с Hyperledger Fabric, JS библиотеками (React, Angular), с Node.js и его взаимодействием с Hyperledger Fabric. Если это не совсем так, то рекомендую вам ознакомиться с [Readme проекта](https://github.com/komaroman/StudReg).

Представим, что вышла новая минорная версия peer образа и мы хотим обновить наш образ и в последствии контейнер. Но мы можем столкнуться с проблемой, при остановке и удалении контейнера peer, все внутреннее содержимое безвозвратно удаляется, мы теряем текущее состояние peer'а, внутреннюю базу CouchDB и при обновлении на новый образ мы не сможем продолжить нашу цепочку транзакций, у нас нет ее истории.

Решить эту проблему лаконично и просто мы сможем путем создания локальных volumes. По сути, это 2 папки, одна будет находится на нашел локальном хосте, а другая в котейнере. Таким образом при самом первом запуске blockchain сети будет проинициализирован volume.

Для peer'а это выглядит следующим образом:
```yml
volumes:
    - ./hyperledger/ordererOrganizations/example.com/orderers/orderer.example.com/production:/var/hyperledger/production
```
То есть, локальный путь можно выбрать любой удобный для вас, а внутренний `/var/hyperledger/production`, необходимо оставить неизменным.

И тоже самое можно провернуть с контйнером CouchDB:
```yml
volumes:
    - ./couchdb/data:/opt/couchdb/data
```

## Chaincode


Запуск нашего приложения для взаимодействия с Hyperledger Fabric мы будем осуществлять с помощью `npm`.
```sh
npm run dev
```
Вас должно перенаправить на страницу с React приложением. Адрес по умолчанию - http://localhost:3000/. С левой части страницы можно отправлять транзакции. С правой части страницы можно по ID делать поиск в ledger'е. В терминале, где был запущен dev сервер, будет выводится log со статусом транзакции.

Можно тестировать!

Текущее состояние ledger'а, а также информацию по всем блокам можно найти в базе данных канала в CouchDB. Адрес сервиса по умолчанию:
http://localhost:5984/_utils/

